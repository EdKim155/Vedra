# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API –∏ –Ω–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ

## ‚ùì –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–µ–¥–∏–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º?

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Telegram API

**–ú–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã (albums) –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–Æ–¢ inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã**

–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Telegram Bot API –∏ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º aiogram:

1. `send_media_group()` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–¥–∏–∞ –∫–∞–∫ –∞–ª—å–±–æ–º
2. Caption –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å **—Ç–æ–ª—å–∫–æ –∫ –ø–µ—Ä–≤–æ–º—É –º–µ–¥–∏–∞** –≤ –≥—Ä—É–ø–ø–µ
3. **Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ù–ï –†–ê–ë–û–¢–ê–Æ–¢** —Å –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞–º–∏

–ò—Å—Ç–æ—á–Ω–∏–∫: aiogram documentation - https://github.com/aiogram/aiogram

```python
# ‚ùå –≠–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢
await bot.send_media_group(
    chat_id=chat_id,
    media=media_group.build(),
    reply_markup=keyboard  # ‚Üê –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢–°–Ø!
)
```

### –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ú–µ–¥–∏–∞ + –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (–¢–ï–ö–£–©–ï–ï)
```
[–ê–ª—å–±–æ–º –∏–∑ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ —Å AI-—Ç–µ–∫—Å—Ç–æ–º]
         ‚Üì
[–°–æ–æ–±—â–µ–Ω–∏–µ: "üëÜ –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º:" + –∫–Ω–æ–ø–∫–∞]
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Caption –≤–∏–¥–µ–Ω —Å—Ä–∞–∑—É –ø–æ–¥ –º–µ–¥–∏–∞
- ‚úÖ –í—Å–µ —Ñ–æ—Ç–æ –≤ –∞–ª—å–±–æ–º–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ–¥–∏–∞

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–¥–Ω–æ —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π
```
[–§–æ—Ç–æ —Å AI-—Ç–µ–∫—Å—Ç–æ–º + –∫–Ω–æ–ø–∫–∞]
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å–µ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢–æ–ª—å–∫–æ –¥–ª—è –û–î–ù–û–ì–û —Ñ–æ—Ç–æ
- ‚ùå –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –î–ª—è –æ–¥–Ω–æ–≥–æ –º–µ–¥–∏–∞:
```python
# –ö–æ–ø–∏—Ä—É–µ–º –º–µ–¥–∏–∞ –ë–ï–ó caption
await bot.copy_message(...)
await bot.edit_message_caption(caption="")

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º AI-—Ç–µ–∫—Å—Ç + –∫–Ω–æ–ø–∫—É
await bot.send_message(text=caption, reply_markup=keyboard)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[–§–æ—Ç–æ –ë–ï–ó —Ç–µ–∫—Å—Ç–∞]
         ‚Üì
[AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è + –∫–Ω–æ–ø–∫–∞ "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã"]
```

### –î–ª—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ):
```python
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–ª—å–±–æ–º —Å AI-—Ç–µ–∫—Å—Ç–æ–º
media_group = MediaGroupBuilder(caption=ai_text)
for photo in photos:
    media_group.add_photo(photo)
await bot.send_media_group(media=media_group.build())

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–¥–µ–ª—å–Ω–æ
await bot.send_message(
    text="üëÜ –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º:",
    reply_markup=keyboard
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[–ê–ª—å–±–æ–º —Ñ–æ—Ç–æ 1]
[–ê–ª—å–±–æ–º —Ñ–æ—Ç–æ 2]
[–ê–ª—å–±–æ–º —Ñ–æ—Ç–æ 3]
  Caption: AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
         ‚Üì
[–°–æ–æ–±—â–µ–Ω–∏–µ: "üëÜ –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º:" + –∫–Ω–æ–ø–∫–∞]
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥ | –û–¥–Ω–æ —Ñ–æ—Ç–æ | –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ | –¢–µ–∫—Å—Ç | –ö–Ω–æ–ø–∫–∞ | –ê–ª—å–±–æ–º |
|--------|-----------|----------------|-------|--------|--------|
| **–¢–µ–∫—É—â–∏–π** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –í—Å–µ –≤ –æ–¥–Ω–æ–º | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ | ‚ùå |
| –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |

## üéØ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:

1. **–û–¥–Ω–æ —Ñ–æ—Ç–æ:**
   - –§–æ—Ç–æ –ë–ï–ó —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   - AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ
   - –ö–Ω–æ–ø–∫–∞

2. **–û–¥–Ω–æ –≤–∏–¥–µ–æ:**
   - –í–∏–¥–µ–æ –ë–ï–ó —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
   - AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ
   - –ö–Ω–æ–ø–∫–∞

3. **–¢–µ–∫—Å—Ç –±–µ–∑ –º–µ–¥–∏–∞:**
   - AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
   - –ö–Ω–æ–ø–∫–∞

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:

4. **–ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ (–º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞):**
   - –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ —Ñ–æ—Ç–æ + –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ "–ï—â–µ X —Ñ–æ—Ç–æ"
   - AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
   - –ö–Ω–æ–ø–∫–∞
   
   **–ü–æ—á–µ–º—É:** Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø—É –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ú—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ.

5. **–í–∏–¥–µ–æ + —Ñ–æ—Ç–æ:**
   - –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –º–µ–¥–∏–∞ + –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ
   - AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
   - –ö–Ω–æ–ø–∫–∞

## üîÆ –ë—É–¥—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø

### –≠—Ç–∞–ø 1: –û–±–Ω–æ–≤–∏—Ç—å Monitor
–°–æ–±–∏—Ä–∞—Ç—å –í–°–ï message_id –∏–∑ –≥—Ä—É–ø–ø—ã:
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å grouped_id
if message.grouped_id:
    # –ë—É—Ñ–µ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
    pending_groups[grouped_id].append(message)
    # –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å—é –≥—Ä—É–ø–ø—É
```

### –≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–∏—Ç—å –ë–î
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è:
```python
media_group_id: Optional[int]  # grouped_id
message_ids: Optional[list[int]]  # –≤—Å–µ message_id
```

### –≠—Ç–∞–ø 3: –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```python
for msg_id in post.message_ids:
    await bot.copy_message(message_id=msg_id)
    await bot.edit_message_caption(caption="")

# –î–æ–±–∞–≤–∏—Ç—å caption –∫ –ø–µ—Ä–≤–æ–º—É
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –≤—Å–µ—Ö
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[–í—Å–µ —Ñ–æ—Ç–æ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞]
  Caption: AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –ø–µ—Ä–≤–æ–º
         ‚Üì
[–ö–Ω–æ–ø–∫–∞: "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã"]
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Aiogram MediaGroupBuilder:** https://github.com/aiogram/aiogram
- **Telegram Bot API Limitations:** https://core.telegram.org/bots/api#sendmediagroup
- **Best Practices:** Context7 / aiogram documentation

## ‚úÖ –ò—Ç–æ–≥

**–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –æ–¥–Ω–æ–≥–æ –º–µ–¥–∏–∞ (—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ)
- ‚úÖ Caption —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–µ–¥–∏–∞
- ‚úÖ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –ú–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã - —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ –º–µ–¥–∏–∞ + –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ

**–≠—Ç–æ –ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ** —É—á–∏—Ç—ã–≤–∞—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API!

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ö—É–∂–µ:
- ‚ùå –ù–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –º–µ–¥–∏–∞ –≤–æ–æ–±—â–µ
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –±–µ–∑ AI-—Ç–µ–∫—Å—Ç–∞
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –±–µ–∑ –∫–Ω–æ–ø–∫–∏

