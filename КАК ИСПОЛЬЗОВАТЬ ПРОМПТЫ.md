# 📖 Как использовать систему промптов для генерации проекта

## 🎯 Что у нас есть

У вас теперь есть **4 файла** для успешной генерации проекта:

1. **`Tz.md`** - Полное техническое задание (версия 1.2)
2. **`Промпты для генерации.md`** - 21 детальный промпт для поэтапной генерации
3. **`Context7 библиотеки.md`** - Справочник по Context7 для получения актуальной документации
4. **`Чеклист генерации.md`** - Чеклист для отслеживания прогресса

---

## 🚀 Быстрый старт

### Шаг 1: Подготовка
```bash
# Создай рабочую директорию
mkdir cars-bot-project
cd cars-bot-project

# Держи все 4 файла под рукой
```

### Шаг 2: Начни с Фазы 1

#### 2.1 Запроси Context7 документацию (если доступно)
```
@context7 получи документацию для SQLAlchemy 2.0 по темам:
- ORM models and relationships
- Async session management
```

#### 2.2 Выполни Промпт 1.1
Скопируй **Промпт 1.1** из файла `Промпты для генерации.md`:

```
Создай структуру Python проекта для Telegram-бота мониторинга 
автомобильных объявлений согласно ТЗ в файле Tz.md.

Требования:
[... полный текст промпта ...]
```

Прикрепи файл `Tz.md` к запросу (если AI поддерживает).

#### 2.3 Проверь результат
```bash
ls src/
cat requirements.txt
```

#### 2.4 Отметь в чеклисте
Открой `Чеклист генерации.md` и отметь:
```markdown
- [x] 1.1 Структура проекта
```

### Шаг 3: Продолжай по порядку
Выполняй промпты последовательно согласно **Порядку выполнения** из файла промптов.

---

## 📋 Рекомендуемый workflow

### 1️⃣ Работа блоками по 2-3 промпта
**НЕ пытайся выполнить все 21 промпт за раз!**

**Хороший подход:**
```
День 1: Промпты 1.1 → 2.1 → 2.2 (Фаза 1)
- Проверка работоспособности
- Тестирование миграций
- Commit в git

День 2: Промпты 3.1 → 3.2 (Начало Фазы 2)
- Тест Google Sheets
- Commit

День 3: Промпты 4.1 → 4.2 (Завершение Фазы 2)
- Тест Telethon мониторинга
- Commit

[и так далее...]
```

### 2️⃣ Используй Context7 перед каждой фазой

**Перед Фазой 1:**
```
@context7 получи документацию для SQLAlchemy 2.0 и Alembic
```

**Перед Фазой 2:**
```
@context7 получи документацию для gspread и Telethon
```

См. полный список в файле `Context7 библиотеки.md`.

### 3️⃣ Проверяй результат после каждого промпта

**Checklist после каждого промпта:**
- [ ] Код генерируется без ошибок
- [ ] Линтер проходит: `ruff check src/`
- [ ] Типы проверяются: `mypy src/`
- [ ] Базовый тест работает
- [ ] Обновлен чеклист

### 4️⃣ Используй уточняющие промпты

Если результат не идеален:

```
Оптимизируй код из предыдущего промпта:
1. Добавь полную обработку ошибок
2. Улучши типизацию (все функции должны иметь type hints)
3. Добавь docstrings в Google style
4. Убедись что код следует SOLID принципам
5. Добавь логирование для важных операций

Используй актуальные best practices Python 3.11+
```

---

## 🎨 Примеры использования

### Пример 1: Генерация с Context7 (идеально)

```
Шаг 1: Запрос документации
─────────────────────────────
@context7 получи документацию для aiogram версии 3 по темам:
- Handlers and routers
- Inline keyboards
- Callback query handling
- Middlewares

Шаг 2: Генерация кода
─────────────────────────────
Теперь используя актуальную документацию aiogram 3, создай 
структуру Telegram бота согласно Промпту 7.1 из файла 
"Промпты для генерации.md" и спецификации в "Tz.md".

[Прикрепить Tz.md если возможно]

Требования:
[... скопировать Промпт 7.1 ...]
```

### Пример 2: Генерация без Context7

```
Создай структуру Telegram бота на aiogram 3.x согласно Промпту 7.1.

Требования из Промпта 7.1:
[... полный текст промпта ...]

Техническое задание:
[... вставить релевантные секции из Tz.md ...]

Используй лучшие практики aiogram 3.x:
- Роутеры вместо диспетчера
- Middleware для проверки подписок
- FSM для диалогов
- Правильная структура проекта
```

### Пример 3: Исправление/улучшение кода

```
У меня есть код для GoogleSheetsManager, но хочу убедиться 
что он оптимален.

@context7 получи документацию для gspread по темам:
- Batch operations
- Caching strategies

Вот текущий код:
[код]

Пожалуйста:
1. Оптимизируй для минимизации API calls
2. Добавь proper caching (60 секунд согласно ТЗ)
3. Улучши обработку ошибок
4. Добавь retry logic
5. Убедись что следует gspread best practices
```

---

## 🔄 Workflow для каждого промпта

```
┌─────────────────────────────────┐
│ 1. Открой "Промпты для          │
│    генерации.md"                │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 2. Проверь Context7 нужен ли    │
│    (см. "Context7 библиотеки")  │
└──────────────┬──────────────────┘
               │
               ▼ (если нужен)
┌─────────────────────────────────┐
│ 3. Запроси Context7             │
│    документацию                 │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 4. Скопируй промпт              │
│    Прикрепи Tz.md (если можно)  │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 5. Выполни промпт               │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 6. Проверь результат            │
│    - Запусти код                │
│    - Проверь линтером           │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 7. Если нужны улучшения -       │
│    уточняющий промпт            │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 8. Отметь в чеклисте            │
│    ("Чеклист генерации.md")     │
└──────────────┬──────────────────┘
               │
               ▼
┌─────────────────────────────────┐
│ 9. Commit в git                 │
└──────────────┬──────────────────┘
               │
               ▼
        Следующий промпт
```

---

## 💡 Лучшие практики

### ✅ DO (Делай)

1. **Читай ТЗ перед началом**
   - Понимай общую архитектуру
   - Знай все требования

2. **Используй Context7**
   - Актуальная документация = меньше ошибок
   - Особенно для быстро меняющихся библиотек (aiogram, openai)

3. **Проверяй после каждого промпта**
   - Запускай код
   - Тестируй базовую функциональность
   - Не накапливай проблемы

4. **Веди чеклист**
   - Видишь прогресс
   - Не забываешь важные части
   - Можешь прерваться и вернуться

5. **Коммить часто**
   ```bash
   git add .
   git commit -m "feat: add google sheets integration (prompt 3.1)"
   ```

6. **Задавай уточняющие вопросы**
   ```
   В промпте 5.1 упомянуто "оптимизация токенов для промптов".
   Можешь конкретно показать как минимизировать токены в 
   CLASSIFY_POST_PROMPT не теряя точность?
   ```

### ❌ DON'T (Не делай)

1. **Не пытайся выполнить все сразу**
   - 21 промпт одновременно = хаос
   - Работай блоками по 2-3

2. **Не пропускай проверки**
   - "Проверю потом" → не проверишь
   - Баги накапливаются

3. **Не игнорируй Context7**
   - Генерация "вслепую" → устаревший код
   - 5 минут на Context7 → часы экономии потом

4. **Не меняй порядок промптов**
   - Они зависят друг от друга
   - Следуй строго по фазам

5. **Не генерируй без понимания**
   - Если не понимаешь промпт - переспроси
   - Если результат непонятен - попроси объяснение

---

## 🎓 Продвинутые техники

### Техника 1: Batch Context7 запросы

Перед началом фазы запроси сразу всю нужную документацию:

```
@context7 получи документацию для следующих библиотек:

1. Telethon - user session authentication, event handlers
2. gspread - batch operations, service account auth

Мне нужно для Фазы 2 (интеграции).
```

### Техника 2: Комбинированные промпты

Если два промпта сильно связаны, можно объединить:

```
Выполни Промпты 5.1 и 5.2 вместе:

1. Создай AIProcessor класс (5.1)
2. Создай оптимизированные промпты (5.2)

При создании промптов (5.2) сразу протестируй их в 
методах AIProcessor (5.1) и покажи примеры результатов.
```

### Техника 3: Итеративная доработка

```
Цикл улучшения:
1. Базовая генерация (промпт как есть)
2. Проверка
3. Промпт: "Улучши [конкретный аспект]"
4. Проверка
5. Если нужно → повтори 3-4
```

---

## 📊 Отслеживание прогресса

### Ежедневно:
```markdown
Дата: 24.10.2025
Выполнено сегодня: Промпты 1.1, 2.1, 2.2
Статус: Фаза 1 завершена
Проблемы: Нет
Следующий шаг: Промпт 3.1 (Google Sheets)
```

### Еженедельно:
```markdown
Неделя 1 (20-26.10.2025)
Фазы: Фаза 1 ✅, Фаза 2 🔄
Промптов выполнено: 7/21
Прогресс: 33%
Блокеры: Нужны credentials для Google Sheets API
```

---

## 🆘 Troubleshooting

### Проблема: "AI генерирует устаревший код"
**Решение:** 
1. Используй Context7 ДО генерации
2. Явно укажи версии в промпте
3. Пример: "используй aiogram 3.x (НЕ 2.x)"

### Проблема: "Код не соответствует ТЗ"
**Решение:**
1. Прикрепляй Tz.md к промпту
2. Цитируй конкретные секции ТЗ
3. Пример: "Согласно разделу 2.3.1 ТЗ формат должен быть..."

### Проблема: "Слишком много кода за раз"
**Решение:**
1. Разбей промпт на части
2. Генерируй модуль за модулем
3. Используй "Сначала создай структуру классов, потом реализацию"

### Проблема: "Зависимости между промптами"
**Решение:**
Строго следуй порядку:
```
Нельзя: Промпт 7.1 → Промпт 2.1
Правильно: Промпт 2.1 → ... → Промпт 7.1
```

### Проблема: "Не понимаю что делать дальше"
**Решение:**
Открой `Чеклист генерации.md`:
1. Найди первый непройденный [ ]
2. Открой соответствующий промпт
3. Проверь нужен ли Context7
4. Выполни

---

## 🎯 Критерии успеха

### Проект успешно сгенерирован когда:

#### Технические критерии:
- [x] Все промпты выполнены
- [x] Docker образ собирается без ошибок
- [x] Все тесты проходят (покрытие >80%)
- [x] Линтеры проходят (ruff, mypy)
- [x] База данных создается и миграции применяются
- [x] Google Sheets подключается
- [x] Telethon мониторит каналы
- [x] AI обрабатывает посты
- [x] Bot отвечает на команды
- [x] Публикация в канал работает

#### Качественные критерии:
- [x] Код читаемый и структурированный
- [x] Есть type hints везде
- [x] Есть docstrings для классов и функций
- [x] Обработка ошибок везде где нужно
- [x] Логирование критических операций
- [x] Документация полная

---

## 📚 Дополнительные ресурсы

### Файлы в проекте:
1. `Tz.md` - ТЗ версии 1.2
2. `Промпты для генерации.md` - Все промпты
3. `Context7 библиотеки.md` - Context7 справка
4. `Чеклист генерации.md` - Tracking прогресса
5. `КАК ИСПОЛЬЗОВАТЬ ПРОМПТЫ.md` - Этот файл

### При возникновении вопросов:
1. Перечитай соответствующий раздел ТЗ
2. Проверь Context7 документацию
3. Переформулируй промпт конкретнее
4. Попроси AI объяснить непонятные части

---

## ✨ Итоговый checklist перед началом

Перед тем как начать генерацию, убедись:

- [ ] Прочитал ТЗ (Tz.md) полностью
- [ ] Понял архитектуру проекта
- [ ] Установил нужные инструменты (Python, Docker, Git)
- [ ] Создал рабочую директорию
- [ ] Открыл все 4 файла для быстрого доступа
- [ ] Готов Context7 (если доступен)
- [ ] Понял workflow (этот файл)
- [ ] Готов работать поэтапно (не спешить)

---

## 🚀 Готов начать?

```
Отлично! Начни с:

1. Открой "Промпты для генерации.md"
2. Найди "Промпт 1.1: Структура проекта"
3. Скопируй промпт
4. Прикрепи Tz.md (если можешь)
5. Запусти генерацию

Удачи! 🎉
```

---

**Помни:** Качество > Скорость. Лучше потратить больше времени на правильную генерацию, чем потом переписывать весь проект.

**Версия инструкции:** 1.0
**Дата:** 2025-10-23

