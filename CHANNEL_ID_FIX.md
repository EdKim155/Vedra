# Исправление ID канала для публикации

## Проблема
Ошибка: `Bad Request: chat not found` при публикации постов

## Причина
Неправильный формат `BOT_NEWS_CHANNEL_ID` в переменных окружения.

## Решение

### Шаг 1: Получите правильный ID канала

**Вариант A: Через username (проще)**
Если у вашего канала есть публичный username (например `@my_news_channel`):
```bash
BOT_NEWS_CHANNEL_ID="@my_news_channel"
```

**Вариант B: Через числовой ID**

1. Добавьте бота **@userinfobot** в ваш канал как администратора
2. Перешлите любое сообщение из канала боту @userinfobot
3. Бот пришлёт информацию, найдите строку `Forwarded from chat:` - это и есть ID канала
4. ID канала должен быть в формате `-100XXXXXXXXXX` (обязательно с минусом!)

Пример правильного ID: `-1002979557335`

### Шаг 2: Обновите переменные окружения

Отредактируйте файл, откуда загружаются переменные (обычно это `.env` или `export_env.sh`):

```bash
# Правильные варианты:
BOT_NEWS_CHANNEL_ID="@your_channel"           # Через username
# или
BOT_NEWS_CHANNEL_ID="-1002979557335"          # Через числовой ID
```

**❌ Неправильно:**
```bash
BOT_NEWS_CHANNEL_ID="2979557335"              # Без минуса и префикса -100
```

### Шаг 3: Перезапустите сервисы

```bash
# Остановите все процессы
pkill -f celery
pkill -f "python.*monitor"
pkill -f "python.*bot"

# Экспортируйте новые переменные
source scripts/export_env.sh

# Запустите заново
make start-all
# или
./scripts/run_all.sh
```

## Проверка

После перезапуска в логах Celery Worker вы должны увидеть:
```
Publishing to channel: @your_channel  # или -1002979557335
```

При успешной публикации:
```
✅ Post X published in Y.XXs (message_id=XXXXX)
```

## Дополнительно: Права бота

Убедитесь, что ваш бот:
1. Добавлен в канал как администратор
2. Имеет права на публикацию сообщений (`Post messages`)
3. Имеет права на редактирование сообщений (опционально)

## Текущее значение

Проверьте текущее значение в логах или выполните:
```bash
echo $BOT_NEWS_CHANNEL_ID
```

Если значение пустое или неправильное - исправьте в файле с переменными окружения.

